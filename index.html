<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Quan ly sinh vien</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
    font-family: Arial, Helvetica, sans-serif;
    background: linear-gradient(120deg,#74ebd5,#9face6);
    min-height:100vh;
    margin:0;
    padding:20px;
}
.container{
    max-width:1100px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:12px;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}
h1{text-align:center;margin-bottom:20px}

.form-add{
    display:grid;
    grid-template-columns: repeat(4,1fr) auto;
    gap:10px;
    margin-bottom:20px;
}
input{
    padding:8px;
    border-radius:6px;
    border:1px solid #ccc;
}
button{
    border:none;
    border-radius:6px;
    padding:8px 12px;
    cursor:pointer;
    color:#fff;
}
.btn-add{background:#28a745}
.btn-edit{background:#ffc107;color:#000}
.btn-delete{background:#dc3545}
.btn-save{background:#007bff}
.btn-cancel{background:#6c757d}

table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    padding:10px;
    border-bottom:1px solid #ddd;
    text-align:center;
}
th{background:#f4f6f8}
.editing{background:#fff3cd}
</style>
</head>

<body>
<div class="container">
<h1>Quan ly sinh vien</h1>

<!-- THEM SINH VIEN -->
<div class="form-add">
    <input id="masv" placeholder="Ma SV">
    <input id="hoten" placeholder="Ho ten">
    <input id="namsinh" placeholder="Nam sinh">
    <input id="lop" placeholder="Lop">
    <button class="btn-add" onclick="addSV()">Them</button>
</div>

<table>
<thead>
<tr>
    <th>ID</th>
    <th>Ma SV</th>
    <th>Ho ten</th>
    <th>Nam sinh</th>
    <th>Lop</th>
    <th>Thao tac</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>
</div>

<script>
const API="https://698592266964f10bf2539cef.mockapi.io/SinhVien";
let editingId=null;

function loadData(){
fetch(API).then(r=>r.json()).then(list=>{
    const tbody=document.getElementById("data");
    tbody.innerHTML="";
    list.forEach(sv=>{
        tbody.innerHTML+=`
        <tr id="row-${sv.id}">
            <td>${sv.id}</td>
            <td>${sv.Masv||""}</td>
            <td>${sv.Hoten||""}</td>
            <td>${sv.NamSinh||""}</td>
            <td>${sv.lop||""}</td>
            <td>
                <button class="btn-edit" onclick="editRow('${sv.id}')">Sua</button>
                <button class="btn-delete" onclick="deleteSV('${sv.id}')">Xoa</button>
            </td>
        </tr>`;
    });
});
}

function addSV(){
if(!masv.value||!hoten.value) return alert("Nhap day du thong tin");
fetch(API,{
    method:"POST",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
        Masv:masv.value,
        Hoten:hoten.value,
        NamSinh:namsinh.value,
        lop:lop.value
    })
}).then(()=>{clearForm();loadData();});
}

function editRow(id){
if(editingId) loadData();
editingId=id;
fetch(API+"/"+id).then(r=>r.json()).then(sv=>{
    const row=document.getElementById("row-"+id);
    row.classList.add("editing");
    row.innerHTML=`
    <td>${id}</td>
    <td><input id="eMasv" value="${sv.Masv||""}"></td>
    <td><input id="eHoten" value="${sv.Hoten||""}"></td>
    <td><input id="eNamSinh" value="${sv.NamSinh||""}"></td>
    <td><input id="eLop" value="${sv.lop||""}"></td>
    <td>
        <button class="btn-save" onclick="saveRow('${id}')">Luu</button>
        <button class="btn-cancel" onclick="cancelEdit()">Huy</button>
    </td>`;
});
}

function saveRow(id){
fetch(API+"/"+id,{
    method:"PUT",
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
        Masv:eMasv.value,
        Hoten:eHoten.value,
        NamSinh:eNamSinh.value,
        lop:eLop.value
    })
}).then(()=>{
    editingId=null;
    loadData();
});
}

function cancelEdit(){
editingId=null;
loadData();
}

function deleteSV(id){
if(confirm("Xoa sinh vien nay?")){
    fetch(API+"/"+id,{method:"DELETE"}).then(loadData);
}
}

function clearForm(){
masv.value="";hoten.value="";namsinh.value="";lop.value="";
}

loadData();
</script>
</body>
</html>
